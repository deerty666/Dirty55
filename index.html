<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ù…Ø·Ø§Ø¹Ù… Ø³Ø­Ø§ÙŠØ¨ Ø¯ÙŠØ±ØªÙŠ â€” Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="manifest" href="/manifest.json">

  <style>
    :root{
      --brown-dark:#2f1b12;
      --brown:#3b2314;
      --gold:#d3a15e;
      --cream:#f6e9d6;
    }
    html,body { font-family: 'Cairo', sans-serif; background: linear-gradient(180deg,var(--brown-dark), #2b1a10); color:var(--cream); }
    .glass { background: rgba(255,255,255,0.03); backdrop-filter: blur(4px); border:1px solid rgba(255,255,255,0.03); }
    #installBanner { display:none; }

    .section-btn { padding:0.5rem 1rem; border-radius:9999px; margin-right:0.5rem; background:rgba(255,255,255,0.03); white-space:nowrap; }
    .menu-item { display:flex; justify-content:space-between; padding:1rem; border-radius:1rem; margin-bottom:0.5rem; background:rgba(255,255,255,0.03); cursor:pointer; }
    .menu-item .icon { font-size:2rem; margin-left:0.5rem; }
    .menu-item .name { font-weight:700; }
    .menu-item .price { font-weight:800; }
    .cart-item { display:flex; justify-content:space-between; padding:0.5rem; border-radius:0.5rem; background:rgba(255,255,255,0.03); margin-bottom:0.5rem; }
  </style>
</head>
<body class="min-h-screen">

  <!-- ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
  <div id="installBanner" class="glass sticky top-0 z-50 p-3 flex justify-center items-center">
    <button id="installButton" class="flex items-center gap-2 px-4 py-2 rounded-xl shadow-md" style="background:var(--gold); color:#2b1a10; font-weight:700;">
      ğŸ“± Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„ØªØ«Ø¨ÙŠØª ØªØ·Ø¨ÙŠÙ‚ Ù…Ø·Ø§Ø¹Ù… Ø³Ø­Ø§ÙŠØ¨ Ø¯ÙŠØ±ØªÙŠ
    </button>
  </div>

  <header class="p-5">
    <div class="max-w-3xl mx-auto">
      <div class="flex items-center justify-between">
        <h1 class="text-3xl" style="color:var(--gold); font-weight:800;">Ù…Ø·Ø§Ø¹Ù… Ø³Ø­Ø§ÙŠØ¨ Ø¯ÙŠØ±ØªÙŠ</h1>
        <div class="flex items-center gap-3">
          <button id="cartBtn" class="relative glass p-2 rounded-lg">ğŸ›’
            <span id="cartCount" class="absolute -top-1 -left-1 bg-amber-400 text-brown-900 text-xs rounded-full px-2">0</span>
          </button>
        </div>
      </div>

      <div class="mt-4">
        <input id="searchInput" dir="rtl" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø·Ø¨Ù‚ Ø£Ùˆ Ù…Ø´Ø±ÙˆØ¨..." class="w-full p-3 rounded-full glass placeholder:opacity-60" />
      </div>

      <div id="sections" class="mt-4 flex gap-3 overflow-x-auto py-2"></div>
    </div>
  </header>

  <main class="max-w-3xl mx-auto pb-28">
    <div id="menuList" class="grid grid-cols-1 gap-4 p-4"></div>
  </main>

  <nav class="fixed bottom-0 left-0 right-0 p-3 glass z-40">
    <div class="max-w-3xl mx-auto flex justify-between items-center">
      <div class="flex gap-6 items-center">
        <button id="homeBtn" class="flex flex-col items-center text-sm">ğŸ½<span>Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</span></button>
        <button id="contactBtn" class="flex flex-col items-center text-sm">ğŸ“<span>ØªÙˆØ§ØµÙ„</span></button>
        <button id="aboutBtn" class="flex flex-col items-center text-sm">â„¹ï¸<span>Ø­ÙˆÙ„Ù†Ø§</span></button>
      </div>
      <div>
        <select id="deliveryOption" class="p-2 rounded-lg glass">
          <option value="pickup">Ø§Ø³ØªÙ„Ø§Ù… Ø¨Ø¯ÙˆÙ† Ø±Ø³ÙˆÙ…</option>
          <option value="delivery">ØªÙˆØµÙŠÙ„ 5 Ø±ÙŠØ§Ù„</option>
        </select>
        <button id="openCartBottom" class="px-4 py-2 rounded-lg" style="background:var(--gold); color:#2b1a10; font-weight:700;">
          Ø¹Ø±Ø¶ Ø§Ù„Ø³Ù„Ø© â€” <span id="cartTotal">0 Ø±ÙŠØ§Ù„</span>
        </button>
      </div>
    </div>
  </nav>

  <!-- Modal -->
  <div id="productModal" class="fixed inset-0 hidden z-50 items-end md:items-center justify-center p-4">
    <div class="bg-[#231610] w-full md:max-w-lg rounded-t-2xl md:rounded-2xl p-5 glass">
      <div class="flex justify-between items-start">
        <div>
          <h2 id="modalTitle" class="text-2xl font-bold"></h2>
        </div>
        <button id="closeModal" class="text-xl">âœ–ï¸</button>
      </div>
      <textarea id="modalOptions" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø© (Ù…Ø«Ù„: Ø¨Ø¯ÙˆÙ† Ù…Ù„Ø­)" class="w-full p-2 mt-4 rounded-md glass" rows="2"></textarea>
      <div class="mt-4 flex justify-between items-center">
        <div class="text-xl font-bold" id="modalPrice">0 Ø±ÙŠØ§Ù„</div>
        <div>
          <button id="addToCartBtn" class="px-4 py-2 rounded-lg" style="background:var(--gold); color:#2b1a10; font-weight:700;">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø© ğŸ›’</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Cart Drawer -->
  <div id="cartDrawer" class="fixed inset-0 hidden z-50">
    <div class="absolute inset-0 bg-black/40" id="cartOverlay"></div>
    <div class="absolute bottom-0 left-0 right-0 bg-[#21140f] rounded-t-2xl p-5 max-h-[80vh] overflow-y-auto">
      <div class="flex justify-between items-center">
        <h3 class="text-xl font-bold">Ø§Ù„Ø³Ù„Ø©</h3>
        <button id="closeCart" class="text-xl">âœ–ï¸</button>
      </div>
      <div id="cartItems" class="mt-4 space-y-3"></div>

      <div class="mt-4 border-t border-white/10 pt-4 flex justify-between items-center">
        <div class="text-lg">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div>
        <div id="cartTotalBottom" class="text-2xl font-bold">0 Ø±ÙŠØ§Ù„</div>
      </div>

      <div class="mt-4 flex gap-3">
        <button id="sendWhatsapp" class="flex-1 py-3 rounded-lg" style="background:var(--gold); color:#2b1a10; font-weight:700;">Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
        <button id="clearCart" class="flex-1 py-3 rounded-lg glass">Ù…Ø³Ø­ Ø§Ù„Ø³Ù„Ø©</button>
      </div>
    </div>
  </div>

  <div id="toast" class="fixed left-1/2 -translate-x-1/2 bottom-28 hidden z-50 p-3 rounded-md" style="background:#111; color:var(--gold);"></div>
  <script>
/********** Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ÙŠÙˆ **********/
const menuData = [
  { section: "Ø§Ù„Ø´ÙˆØ§ÙŠÙ‡", items:[
    { id:"sh1", icon:"ğŸ—", name:"Ø´ÙˆØ§ÙŠØ© - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø© (Ø±Ø² Ø´Ø¹Ø¨ÙŠ)", price:46 },
    { id:"sh2", icon:"ğŸ—", name:"Ø´ÙˆØ§ÙŠØ© - Ù†ØµÙ Ø­Ø¨Ø© (Ø±Ø² Ø´Ø¹Ø¨ÙŠ)", price:24 },
    { id:"sh3", icon:"ğŸ—", name:"Ø´ÙˆØ§ÙŠØ© - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø© (Ø±Ø² Ø¨Ø´Ø§ÙˆØ±)", price:50 },
    { id:"sh4", icon:"ğŸ—", name:"Ø´ÙˆØ§ÙŠØ© - Ù†ØµÙ Ø­Ø¨Ø© (Ø±Ø² Ø¨Ø´Ø§ÙˆØ±)", price:25 },
    { id:"sh5", icon:"ğŸ—", name:"Ø´ÙˆØ§ÙŠØ© - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø© (Ø±Ø² Ù…Ù†Ø¯ÙŠ)", price:50 },
    { id:"sh6", icon:"ğŸ—", name:"Ø´ÙˆØ§ÙŠØ© - Ù†ØµÙ Ø­Ø¨Ø© (Ø±Ø² Ù…Ù†Ø¯ÙŠ)", price:25 },
    { id:"sh7", icon:"ğŸ—", name:"Ø´ÙˆØ§ÙŠØ© - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø© (Ø±Ø² Ù…Ø«Ù„ÙˆØ«Ù‡)", price:50 },
    { id:"sh8", icon:"ğŸ—", name:"Ø´ÙˆØ§ÙŠØ© - Ù†ØµÙ Ø­Ø¨Ø© (Ø±Ø² Ù…Ø«Ù„ÙˆØ«Ù‡)", price:25 }
  ]},
  { section: "Ù…Ø¸Ø¨ÙŠ", items:[
    { id:"md1", icon:"ğŸ–", name:"Ù…Ø¸Ø¨ÙŠ - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø© (Ø±Ø² Ø´Ø¹Ø¨ÙŠ)", price:46 },
    { id:"md2", icon:"ğŸ–", name:"Ù…Ø¸Ø¨ÙŠ - Ù†ØµÙ Ø­Ø¨Ø© (Ø±Ø² Ø´Ø¹Ø¨ÙŠ)", price:24 },
    { id:"md3", icon:"ğŸ–", name:"Ù…Ø¸Ø¨ÙŠ - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø© (Ø±Ø² Ø¨Ø´Ø§ÙˆØ±)", price:50 },
    { id:"md4", icon:"ğŸ–", name:"Ù…Ø¸Ø¨ÙŠ - Ù†ØµÙ Ø­Ø¨Ø© (Ø±Ø² Ø¨Ø´Ø§ÙˆØ±)", price:25 },
    { id:"md5", icon:"ğŸ–", name:"Ù…Ø¸Ø¨ÙŠ - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø© (Ø±Ø² Ù…Ù†Ø¯ÙŠ)", price:50 },
    { id:"md6", icon:"ğŸ–", name:"Ù…Ø¸Ø¨ÙŠ - Ù†ØµÙ Ø­Ø¨Ø© (Ø±Ø² Ù…Ù†Ø¯ÙŠ)", price:25 },
    { id:"md7", icon:"ğŸ–", name:"Ù…Ø¸Ø¨ÙŠ - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø© (Ø±Ø² Ù…Ø«Ù„ÙˆØ«Ù‡)", price:50 },
    { id:"md8", icon:"ğŸ–", name:"Ù…Ø¸Ø¨ÙŠ - Ù†ØµÙ Ø­Ø¨Ø© (Ø±Ø² Ù…Ø«Ù„ÙˆØ«Ù‡)", price:25 }
  ]},
  { section: "Ù…Ù†Ø¯ÙŠ", items:[
    { id:"mn1", icon:"ğŸ›", name:"Ù…Ù†Ø¯ÙŠ - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø© (Ø±Ø² Ø´Ø¹Ø¨ÙŠ)", price:46 },
    { id:"mn2", icon:"ğŸ›", name:"Ù…Ù†Ø¯ÙŠ - Ù†ØµÙ Ø­Ø¨Ø© (Ø±Ø² Ø´Ø¹Ø¨ÙŠ)", price:24 },
    { id:"mn3", icon:"ğŸ›", name:"Ù…Ù†Ø¯ÙŠ - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø© (Ø±Ø² Ø¨Ø´Ø§ÙˆØ±)", price:50 },
    { id:"mn4", icon:"ğŸ›", name:"Ù…Ù†Ø¯ÙŠ - Ù†ØµÙ Ø­Ø¨Ø© (Ø±Ø² Ø¨Ø´Ø§ÙˆØ±)", price:25 },
    { id:"mn5", icon:"ğŸ›", name:"Ù…Ù†Ø¯ÙŠ - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø© (Ø±Ø² Ù…Ù†Ø¯ÙŠ)", price:50 },
    { id:"mn6", icon:"ğŸ›", name:"Ù…Ù†Ø¯ÙŠ - Ù†ØµÙ Ø­Ø¨Ø© (Ø±Ø² Ù…Ù†Ø¯ÙŠ)", price:25 },
    { id:"mn7", icon:"ğŸ›", name:"Ù…Ù†Ø¯ÙŠ - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø© (Ø±Ø² Ù…Ø«Ù„ÙˆØ«Ù‡)", price:50 },
    { id:"mn8", icon:"ğŸ›", name:"Ù…Ù†Ø¯ÙŠ - Ù†ØµÙ Ø­Ø¨Ø© (Ø±Ø² Ù…Ø«Ù„ÙˆØ«Ù‡)", price:25 }
  ]},
  { section: "Ù…Ø¶ØºÙˆØ·", items:[
    { id:"mp1", icon:"ğŸ½ï¸", name:"Ù…Ø¶ØºÙˆØ· - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø©", price:50 },
    { id:"mp2", icon:"ğŸ½ï¸", name:"Ù…Ø¶ØºÙˆØ· - Ù†ØµÙ Ø­Ø¨Ø©", price:25 }
  ]},
  { section: "Ø²Ø±Ø¨ÙŠØ§Ù†", items:[
    { id:"zr1", icon:"ğŸš", name:"Ø²Ø±Ø¨ÙŠØ§Ù† - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø©", price:50 },
    { id:"zr2", icon:"ğŸš", name:"Ø²Ø±Ø¨ÙŠØ§Ù† - Ù†ØµÙ Ø­Ø¨Ø©", price:25 }
  ]},
  { section: "Ù…Ù‚Ù„ÙˆØ¨Ù‡", items:[
    { id:"mq1", icon:"ğŸ²", name:"Ù…Ù‚Ù„ÙˆØ¨Ù‡ - Ø­Ø¨Ø© ÙƒØ§Ù…Ù„Ø©", price:50 },
    { id:"mq2", icon:"ğŸ²", name:"Ù…Ù‚Ù„ÙˆØ¨Ù‡ - Ù†ØµÙ Ø­Ø¨Ø©", price:25 }
  ]},
  { section: "Ù‚Ø³Ù… Ø§Ù„Ø­Ù…", items:[
    { id:"t1", icon:"ğŸ", name:"ØªÙŠØ³ ÙƒØ§Ù…Ù„ Ù…Ù†Ø¯ÙŠ - Ø±Ø² Ø´Ø¹Ø¨ÙŠ", price:1500 },
    { id:"t2", icon:"ğŸ", name:"ØªÙŠØ³ ÙƒØ§Ù…Ù„ Ù…Ù†Ø¯ÙŠ - Ø±Ø² Ù…Ù†Ø¯ÙŠ", price:1600 },
    { id:"t3", icon:"ğŸ", name:"ØªÙŠØ³ ÙƒØ§Ù…Ù„ Ù…Ù†Ø¯ÙŠ - Ø±Ø² Ø¨Ø´Ø§ÙˆØ±", price:1600 },
    { id:"t4", icon:"ğŸ", name:"Ù†Øµ ØªÙŠØ³ Ù…Ù†Ø¯ÙŠ - Ø±Ø² Ø´Ø¹Ø¨ÙŠ", price:750 },
    { id:"t5", icon:"ğŸ", name:"Ù†Øµ ØªÙŠØ³ Ù…Ù†Ø¯ÙŠ - Ø±Ø² Ø¨Ø´Ø§ÙˆØ±", price:775 },
    { id:"t6", icon:"ğŸ", name:"Ù†Øµ ØªÙŠØ³ - Ø±Ø² Ù…Ù†Ø¯ÙŠ", price:775 },
    { id:"t7", icon:"ğŸ", name:"Ø±Ø¨Ø¹ ØªÙŠØ³ Ù…Ù†Ø¯ÙŠ - Ø±Ø² Ø´Ø¹Ø¨ÙŠ", price:0 },
    { id:"t8", icon:"ğŸ–", name:"Ù†ÙØ± Ù„Ø­Ù… ØªÙŠØ³ Ù…Ù†Ø¯ÙŠ - Ø±Ø² Ø´Ø¹Ø¨ÙŠ", price:85 },
    { id:"t9", icon:"ğŸ„", name:"Ù„Ø­Ù… Ø­Ø§Ø´ÙŠ Ù…ÙƒÙ…ÙˆØª - Ø±Ø² Ø´Ø¹Ø¨ÙŠ", price:50 },
    { id:"t10", icon:"ğŸ¥©", name:"Ù„Ø­Ù… Ø¨Ø±Ù…Ù‡ Ù†Ø¹ÙŠÙ…ÙŠ Ù…Ø¹ Ø§Ù„Ù…Ø±Ù‚ - Ø±Ø² Ø´Ø¹Ø¨ÙŠ", price:68 }
  ]},
  { section: "Ø§Ù„Ù…Ø´ÙˆÙŠØ§Øª", items:[
    { id:"k1", icon:"ğŸ¢", name:"ÙƒØ¨Ø§Ø¨ Ù„Ø­Ù… - Ù†ÙØ±", price:38 },
    { id:"k2", icon:"ğŸ¢", name:"ÙƒØ¨Ø§Ø¨ Ù„Ø­Ù… - Ù†Øµ ÙƒÙŠÙ„Ùˆ", price:76 },
    { id:"k3", icon:"ğŸ¢", name:"ÙƒØ¨Ø§Ø¨ Ù„Ø­Ù… - ÙƒÙŠÙ„Ùˆ", price:150 },
    { id:"k4", icon:"ğŸ¥©", name:"Ø§ÙˆØµÙ„ Ù„Ø­Ù… - Ù†ÙØ±", price:45 },
    { id:"k5", icon:"ğŸ—", name:"ÙƒØ¨Ø§Ø¨ Ø¯Ø¬Ø§Ø¬ - Ù†ÙØ±", price:30 },
    { id:"k6", icon:"ğŸ—", name:"ÙƒØ¨Ø§Ø¨ Ø¯Ø¬Ø§Ø¬ - Ù†Øµ ÙƒÙŠÙ„Ùˆ", price:60 },
    { id:"k7", icon:"ğŸ—", name:"ÙƒØ¨Ø§Ø¨ Ø¯Ø¬Ø§Ø¬ - ÙƒÙŠÙ„Ùˆ", price:120 },
    { id:"k8", icon:"ğŸ—", name:"Ø´ÙŠØ´ Ø·Ø§ÙˆÙ‚ - Ù†ÙØ±", price:30 },
    { id:"k9", icon:"ğŸ—", name:"Ø´ÙŠØ´ Ø·Ø§ÙˆÙ‚ - Ù†Øµ ÙƒÙŠÙ„Ùˆ", price:60 },
    { id:"k10", icon:"ğŸ—", name:"Ø´ÙŠØ´ Ø·Ø§ÙˆÙ‚ - ÙƒÙŠÙ„Ùˆ", price:120 }
  ]},
  { section: "Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª", items:[
    { id:"add1", icon:"â•", name:"Ù†ÙØ± Ø±Ø² Ø´Ø¹Ø¨ÙŠ", price:10 },
    { id:"add2", icon:"â•", name:"Ù†ÙØ± Ø±Ø² Ù…Ù†Ø¯ÙŠ", price:10 },
    { id:"add3", icon:"â•", name:"Ù†ÙØ± Ø±Ø² Ø¨Ø´Ø§ÙˆØ±", price:10 },
    { id:"add4", icon:"ğŸ¥—", name:"Ø³Ù„Ø·Ù‡ Ø­Ø§Ø±", price:3 },
    { id:"add5", icon:"ğŸ¥£", name:"Ø·Ø­ÙŠÙ†Ù‡", price:3 }
  ]}
];

/********** Ø¹Ù†Ø§ØµØ± Ø§Ù„ØµÙØ­Ø© **********/
const sectionsEl = document.getElementById('sections');
const menuList = document.getElementById('menuList');
const searchInput = document.getElementById('searchInput');
const productModal = document.getElementById('productModal');
const modalTitle = document.getElementById('modalTitle');
const modalOptions = document.getElementById('modalOptions');
const modalPrice = document.getElementById('modalPrice');
const addToCartBtn = document.getElementById('addToCartBtn');
const closeModal = document.getElementById('closeModal');
const cartDrawer = document.getElementById('cartDrawer');
const cartOverlay = document.getElementById('cartOverlay');
const cartItemsEl = document.getElementById('cartItems');
const cartTotalBottom = document.getElementById('cartTotalBottom');
const cartTotal = document.getElementById('cartTotal');
const cartCount = document.getElementById('cartCount');
const deliveryOption = document.getElementById('deliveryOption');

let cart = JSON.parse(localStorage.getItem('deerty_cart') || '[]');
let currentItem = null;

/********** Ø§Ù„Ø¯ÙˆØ§Ù„ **********/
function renderSections(){
  sectionsEl.innerHTML='';
  menuData.forEach((sec,idx)=>{
    const btn = document.createElement('button');
    btn.className='section-btn';
    btn.innerText = sec.section;
    btn.onclick = ()=>renderMenu(sec.section);
    sectionsEl.appendChild(btn);
    if(idx===0) btn.click();
  });
}

function renderMenu(sectionName){
  menuList.innerHTML='';
  const filtered = menuData.find(s=>s.section===sectionName);
  if(!filtered) return;
  filtered.items.forEach(item=>{
    const card = document.createElement('div');
    card.className='menu-item';
    card.innerHTML=`
      <div class="flex items-center">
        <div class="icon">${item.icon}</div>
        <div class="name">${item.name}</div>
      </div>
      <div class="flex flex-col items-end">
        <div class="price">${item.price} Ø±ÙŠØ§Ù„</div>
        <button class="mt-2 px-3 py-1 rounded-lg" style="background:var(--gold); color:#2b1a10; font-weight:700;" data-id="${item.id}">Ø¹Ø±Ø¶</button>
      </div>
    `;
    card.querySelector('button').addEventListener('click',()=>openModal(item));
    menuList.appendChild(card);
  });
}

searchInput.addEventListener('input',(e)=>{
  const q = e.target.value.trim();
  if(!q){document.querySelectorAll('#sections button')[0]?.click(); return;}
  const results=[];
  menuData.forEach(sec=>sec.items.forEach(it=>{
    if(it.name.includes(q) || it.name.replace(/\s/g,'').includes(q.replace(/\s/g,''))){
      results.push({...it, section: sec.section});
    }
  }));
  menuList.innerHTML='';
  if(results.length===0){menuList.innerHTML='<div class="p-4 glass rounded-xl">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</div>'; return;}
  results.forEach(item=>{
    const card = document.createElement('div');
    card.className='menu-item';
    card.innerHTML=`
      <div class="flex items-center">
        <div class="icon">${item.icon}</div>
        <div class="name">${item.name}</div>
      </div>
      <div class="flex flex-col items-end">
        <div class="price">${item.price} Ø±ÙŠØ§Ù„</div>
        <button class="mt-2 px-3 py-1 rounded-lg" style="background:var(--gold); color:#2b1a10; font-weight:700;" data-id="${item.id}">Ø¹Ø±Ø¶</button>
      </div>
    `;
    card.querySelector('button').addEventListener('click',()=>openModal(item));
    menuList.appendChild(card);
  });
});

/********** Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ **********/
function openModal(item){
  currentItem=item;
  modalTitle.innerText=item.name;
  modalOptions.value='';
  modalPrice.innerText=item.price+' Ø±ÙŠØ§Ù„';
  addToCartBtn.onclick=()=>{
    const note = modalOptions.value || '';
    const qty = 1;
    addToCart({...item, qty, note});
    hideModal();
  };
  productModal.classList.remove('hidden'); productModal.classList.add('flex');
}
function hideModal(){ productModal.classList.remove('flex'); productModal.classList.add('hidden'); }
closeModal.addEventListener('click',hideModal);
productModal.addEventListener('click',(e)=>{if(e.target===productModal) hideModal();});

/********** Ø§Ù„Ø³Ù„Ø© **********/
function addToCart(item){
  const found = cart.find(i=>i.id===item.id && i.note===item.note);
  if(found) found.qty+=item.qty; else cart.push({...item});
  showToast('ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©');
  saveCart();
}
function saveCart(){ localStorage.setItem('deerty_cart',JSON.stringify(cart)); renderCart(); }
function renderCart(){
  cartItemsEl.innerHTML='';
  let total=0, count=0;
  cart.forEach((it,idx)=>{
    const row = document.createElement('div');
    row.className='cart-item';
    row.innerHTML=`
      <div>${it.name}${it.note?'<br><span class="opacity-60 text-sm">Ù…Ù„Ø§Ø­Ø¸Ø©: '+it.note+'</span>':''}</div>
      <div class="text-right">
        <div>${it.price*it.qty} Ø±ÙŠØ§Ù„</div>
        <div class="flex gap-2 mt-2 justify-end items-center">
          <button class="glass px-2 py-1" data-action="dec" data-idx="${idx}">-</button>
          <div class="px-2">${it.qty}</div>
          <button class="glass px-2 py-1" data-action="inc" data-idx="${idx}">+</button>
          <button class="glass px-2 py-1" data-action="remove" data-idx="${idx}">Ø­Ø°Ù</button>
        </div>
      </div>
    `;
    cartItemsEl.appendChild(row);
    total+=it.price*it.qty; count+=it.qty;
  });
  // Ø¥Ø¶Ø§ÙØ© Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„
  const deliveryFee = deliveryOption.value==='delivery'?5:0;
  cartTotalBottom.innerText = (total+deliveryFee)+' Ø±ÙŠØ§Ù„';
  cartTotal.innerText = (total+deliveryFee)+' Ø±ÙŠØ§Ù„';
  cartCount.innerText=count;
  cartCount.style.display=count===0?'none':'inline-block';
}

cartItemsEl.addEventListener('click',(e)=>{
  const action=e.target.dataset.action;
  const idx=e.target.dataset.idx;
  if(!action) return;
  if(action==='inc'){cart[idx].qty++; saveCart();}
  if(action==='dec'){if(cart[idx].qty>1) cart[idx].qty--; else cart.splice(idx,1); saveCart();}
  if(action==='remove'){cart.splice(idx,1); saveCart();}
});

/********** Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø³Ù„Ø© **********/
document.getElementById('openCartBottom').addEventListener('click',()=>{cartDrawer.classList.remove('hidden'); cartDrawer.classList.add('block'); renderCart();});
document.getElementById('cartBtn').addEventListener('click',()=>{cartDrawer.classList.remove('hidden'); cartDrawer.classList.add('block'); renderCart();});
document.getElementById('closeCart').addEventListener('click',()=>cartDrawer.classList.add('hidden'));
cartOverlay.addEventListener('click',()=>cartDrawer.classList.add('hidden'));
document.getElementById('clearCart').addEventListener('click',()=>{cart=[]; saveCart(); showToast('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø³Ù„Ø©');});

/********** Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³Ø§Ø¨ **********/
const whatsappPhone='966536803598';
document.getElementById('sendWhatsapp').addEventListener('click',()=>{
  if(cart.length===0){showToast('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©'); return;}
  const lines=['Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ù…Ø·Ø§Ø¹Ù… Ø³Ø­Ø§ÙŠØ¨ Ø¯ÙŠØ±ØªÙŠ:'];
  cart.forEach(it=>{
    lines.push(`${it.qty} Ã— ${it.name} â€” ${it.price*it.qty} Ø±ÙŠØ§Ù„${it.note?' (Ù…Ù„Ø§Ø­Ø¸Ø©: '+it.note+')':''}`);
  });
  const total=cart.reduce((s,i)=>s+i.price*i.qty,0)+(deliveryOption.value==='delivery'?5:0);
  lines.push(`Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„: ${deliveryOption.value==='delivery'?5:0} Ø±ÙŠØ§Ù„`);
  lines.push(`Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total} Ø±ÙŠØ§Ù„`);
  const text=encodeURIComponent(lines.join('\n'));
  const url=`https://wa.me/${whatsappPhone}?text=${text}`;
  window.open(url,'_blank');
});

/********** ØªÙˆØ³Øª **********/
function showToast(msg,time=2000){
  const t=document.getElementById('toast');
  t.innerText=msg;
  t.classList.remove('hidden'); t.classList.add('block');
  setTimeout(()=>{t.classList.remove('block'); t.classList.add('hidden');},time);
}

/********** PWA install **********/
let deferredPrompt;
const installBanner=document.getElementById('installBanner');
const installButton=document.getElementById('installButton');
window.addEventListener('beforeinstallprompt', (e)=>{
  e.preventDefault();
  deferredPrompt=e;
  installBanner.style.display='block';
});
installButton.addEventListener('click', async ()=>{
  installBanner.style.display='none';
  if(!deferredPrompt) return;
  deferredPrompt.prompt();
  const choice = await deferredPrompt.userChoice;
  if(choice.outcome==='accepted') showToast('Ø´ÙƒØ±Ø§Ù‹! ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø§Ù„ØªØ«Ø¨ÙŠØª'); else showToast('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ«Ø¨ÙŠØª');
  deferredPrompt=null;
});
window.addEventListener('appinstalled',()=>{installBanner.style.display='none';});

/********** Service Worker **********/
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('/sw.js').then(()=>console.log('SW registered')).catch(err=>console.log('SW err',err));
}

/********** init **********/
renderSections();
renderCart();
</script>
</body>
</html>
